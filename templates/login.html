{% extends 'base.html' %}
{% block title %}Sign In â€” Behavioral Health Vault{% endblock %}
{% block content %}
<section class="section">
  <div class="container" style="max-width:480px">
    <div class="card">
      <div class="section-header" style="text-align:center;margin-bottom:1.5rem">
        <h2 class="section-title" style="font-size:1.5rem">Welcome Back</h2>
        <p class="section-subtitle">Sign in to your Behavioral Health Vault account.</p>
      </div>

      <form method="post">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>

        <label for="email">Email Address</label>
        <input id="email" name="email" type="email" placeholder="you@example.com" required />

        <label for="password">Password</label>
        <input id="password" name="password" type="password" placeholder="Your password" required />

        <div class="btn-group">
          <button class="btn btn-primary" type="submit">Sign In</button>
          <a class="btn btn-secondary" href="{{ url_for('signup') }}">Create Account</a>
        </div>
      </form>

      <div class="oauth-divider">Or sign in with</div>

      <div id="g_id_onload"
           data-client_id="{{ config.get('GOOGLE_CLIENT_ID', '') }}"
           data-callback="handleCredentialResponse">
      </div>
      <div class="g_id_signin" data-type="standard"></div>

      <p style="text-align:center;margin-top:1rem;font-size:.875rem;color:var(--slate-400)">
        Don't have an account? <a href="{{ url_for('signup') }}">Create one free</a>
      </p>
    </div>
  </div>
</section>

<script src="https://accounts.google.com/gsi/client" async defer></script>
<script>
function handleCredentialResponse(response) {
  const form = document.createElement('form');
  form.method = 'POST';
  form.action = '{{ url_for('auth_google') }}';
  const tokenInput = document.createElement('input');
  tokenInput.type = 'hidden';
  tokenInput.name = 'token';
  tokenInput.value = response.credential;
  form.appendChild(tokenInput);
  document.body.appendChild(form);
  form.submit();
}
</script>
{% endblock %}

